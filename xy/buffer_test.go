package xy_test

import (
	"github.com/twpayne/go-geom"
	"github.com/twpayne/go-geom/xy"
	"reflect"
	"testing"
)

func TestBuffer(t *testing.T) {
	line := geom.NewLineStringFlat(geom.XY, []float64{0, 0, 10, 10})
	buffer := xy.Buffer(line, 10)

	expected := []float64{
		2.9289321881345254, 17.071067811865476, 4.44429766980398, 18.314696123025453, 6.173165676349103,
		19.238795325112868, 8.049096779838719, 19.807852804032304, 10.0, 20.0, 11.950903220161283,
		19.807852804032304, 13.826834323650898, 19.238795325112868, 15.555702330196024, 18.314696123025453,
		17.071067811865476, 17.071067811865476, 18.314696123025453, 15.555702330196022, 19.238795325112868,
		13.826834323650898, 19.807852804032304, 11.950903220161285, 20.0, 10.0, 19.807852804032304,
		8.049096779838715, 19.238795325112868, 6.1731656763490985, 18.31469612302545, 4.444297669803973,
		17.071067811865476, 2.9289321881345254, 7.071067811865475, -7.071067811865475, 5.555702330196023,
		-8.314696123025453, 3.8268343236508984, -9.238795325112868, 1.9509032201612833, -9.807852804032304,
		6.123233995736766E-16, -10.0, -1.950903220161282, -9.807852804032304, -3.826834323650897,
		-9.238795325112868, -5.55570233019602, -8.314696123025453, -7.071067811865475,
		-7.0710678118654755, -8.314696123025453, -5.555702330196022, -9.238795325112868, -3.826834323650899,
		-9.807852804032304, -1.9509032201612861, -10.0, -1.2246467991473533E-15, -9.807852804032304,
		1.9509032201612837, -9.238795325112866, 3.8268343236509006, -8.314696123025449, 5.555702330196026,
		-7.071067811865475, 7.071067811865475, 2.9289321881345254, 17.071067811865476,
	}

	if !reflect.DeepEqual(buffer.FlatCoords(), expected) {
		t.Errorf("xy.Buffer(%v, 10) did not give expected result: %v", line.FlatCoords(), buffer.FlatCoords())
	}
}
